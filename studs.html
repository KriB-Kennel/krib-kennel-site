<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>KriB Kennel | Studs</title>
  <meta name="description" content="KriB Kennel Studs & Pedigree." />

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Anton&display=swap" rel="stylesheet">

  <link rel="stylesheet" href="./styles.css" />
  <link rel="stylesheet" href="./gold-rain.css" />
</head>

<body>
  <div class="bg" aria-hidden="true"></div>
  <div class="gold-rain" aria-hidden="true"></div>

  <main class="wrap">

    <!-- HEADER -->
    <header class="card header">
      <button class="navbtn" id="navBtn" type="button" aria-label="Menu">
        <div class="navicon" aria-hidden="true"><span></span><span></span><span></span></div>
      </button>

      <img class="logo" id="logo" src="./assets/logo.png" alt="Logo" />
      <div class="tagline" id="tagline">Servicio • Ciudad • Respuesta rápida</div>

      <div class="lang">
        <button class="langbtn" id="langEN" type="button">EN</button>
        <button class="langbtn" id="langES" type="button">ES</button>
      </div>
    </header>

    <!-- NAV -->
    <div class="nav-overlay" id="navOverlay" aria-hidden="true"></div>
    <aside class="nav-drawer" id="navDrawer" aria-label="Site navigation">
      <div class="nav-top">
        <div class="nav-title" id="navTitle">Menu</div>
        <button class="nav-close" id="navClose" type="button" aria-label="Close">✕</button>
      </div>
      <nav class="nav-links" id="navLinks"></nav>
      <div class="nav-foot">
        <a class="sbtn primary" id="navCall" href="#">Call</a>
        <a class="sbtn" id="navWhats" href="#" target="_blank" rel="noopener">WhatsApp</a>
      </div>
    </aside>

    <!-- STUDS -->
    <section class="card section">
      <h2 class="section-title" id="studsTitle">Studs</h2>
      <p class="section-lead" id="studsLead">Featured stud with pedigree and description.</p>

      <div class="dogs-grid" id="studsGrid"></div>
    </section>

    <footer class="footer">
      <div class="brand" id="footerBrand">KriB Kennel</div>
      <div class="copy">
        © <span id="year"></span> •
        <a id="footerLink" href="#" target="_blank" rel="noopener">RaymondDevelop</a>
      </div>
    </footer>
  </main>

  <nav class="sticky">
    <a class="sbtn primary" id="sCall" href="#">Call</a>
    <a class="sbtn" id="sWhats" href="#" target="_blank" rel="noopener">WhatsApp</a>
  </nav>

  <script src="./config.js"></script>
  <script>
    const $ = (id) => document.getElementById(id);
    function safeText(el, v){ if(el) el.textContent = v ?? ""; }
    function safeHref(el, v){ if(el && v) el.href = v; }
    function safeSrc(el, v){ if(el && v) el.src = v; }

    // Apply CSS vars from config
    const root = document.documentElement.style;
    Object.entries(SITE.colors || {}).forEach(([k,v]) => root.setProperty(`--${k}`, v));

    // Header logo + tagline
    safeSrc($("logo"), SITE.assets?.logo || "./assets/logo.png");
    if ($("logo")) $("logo").alt = SITE.brand || "Logo";
    safeText($("tagline"), SITE.header?.tagline || "");

    // Contact links
    const tel1 = SITE.contact?.phone1 || "";
    const tel1Clean = SITE.contact?.phone1E164 || "";
    const telHref1 = `tel:${tel1Clean || tel1.replace(/[^0-9+]/g,"")}`;

    const wa = SITE.contact?.whatsappE164 || "";
    const waMsg = encodeURIComponent(SITE.contact?.whatsappMessage || "Hello, I need information.");
    const waLink = wa ? `https://wa.me/${wa}?text=${waMsg}` : "#";

    safeHref($("sCall"), telHref1);
    safeHref($("sWhats"), waLink);

    // Language helpers
    function getLang(){ return localStorage.getItem("lang") || SITE.defaultLang || "en"; }
    function paintLangButtons(lang){
      $("langEN")?.classList.toggle("active", lang === "en");
      $("langES")?.classList.toggle("active", lang === "es");
    }
    function t(key){
      const lang = getLang();
      return (SITE.i18n?.[lang]?.[key]) ?? (SITE.i18n?.en?.[key]) ?? null;
    }

    // NAV
    function openNav(){ document.body.classList.add("nav-open"); }
    function closeNav(){ document.body.classList.remove("nav-open"); }
    $("navBtn")?.addEventListener("click", openNav);
    $("navClose")?.addEventListener("click", closeNav);
    $("navOverlay")?.addEventListener("click", closeNav);
    document.addEventListener("keydown", (e)=>{ if(e.key==="Escape") closeNav(); });

    function navLabel(item){
      const key = item.labelKey;
      if (key && SITE.i18n) return t(key) || item.label || "";
      return item.label || "";
    }

    function renderNav(){
      const nav = $("navLinks");
      if(!nav) return;

      const items = SITE.nav?.items || [
        { href:"./index.html#inicio", labelKey:"navHome", label:"Home" },
        { href:"./gallery.html", labelKey:"navGallery", label:"Gallery" },
        { href:"./studs.html", labelKey:"navStuds", label:"Studs" }
      ];

      const here = (location.pathname.split("/").pop() || "index.html").toLowerCase();
      nav.innerHTML = "";

      items.forEach((it)=>{
        const a = document.createElement("a");
        a.href = it.href;

        const targetFile = (it.href.split("#")[0].split("/").pop() || "index.html").toLowerCase();
        if (targetFile === here) a.classList.add("active");

        a.textContent = navLabel(it);
        a.addEventListener("click", closeNav);
        nav.appendChild(a);
      });

      safeHref($("navCall"), telHref1);
      safeHref($("navWhats"), waLink);
      safeText($("navCall"), t("callBtn") || "Call");
      safeText($("navWhats"), t("waBtn") || "WhatsApp");
      safeText($("navTitle"), t("navTitle") || "Menu");
    }
function extractYouTubeId(input){
  if(!input) return "";
  const s = String(input).trim();

  const m1 = s.match(/youtu\.be\/([a-zA-Z0-9_-]+)/);
  if (m1) return m1[1];

  const ms = s.match(/\/shorts\/([a-zA-Z0-9_-]+)/);
  if (ms) return ms[1];

  const m2 = s.match(/[?&]v=([a-zA-Z0-9_-]+)/);
  if (m2) return m2[1];

  return "";
}
    // STUDS render (ONLY 1) + pedigree toggle
    function renderStud(){
      const grid = $("studsGrid");
      if(!grid) return;

      const lang = getLang();
      const items =
        SITE.studs?.items?.[lang] ||
        SITE.studs?.items?.en ||
        SITE.studs?.items ||
        [];

      const d = items[0];
      grid.innerHTML = "";

      if(!d){
        grid.innerHTML = `
          <div class="item">
            <div class="dot" aria-hidden="true"></div>
            <div>
              <div class="it-title">No stud data</div>
              <div class="it-desc">Add SITE.studs.items in config.js</div>
            </div>
          </div>`;
        return;
      }

      const card = document.createElement("article");
      card.className = "dog";
  const videoId = extractYouTubeId(d.video || "");

card.innerHTML = `
  <img class="dog-img" src="${d.img}" loading="lazy" />

  <div class="dog-body">
    <h3 class="dog-name">${d.name || ""}</h3>
    <p class="dog-ped">${d.pedigree || ""}</p>

    ${videoId ? `
      <div class="photo" style="margin:10px 0;">
        <div style="position:relative;width:100%;padding-top:56.25%;overflow:hidden;border-radius:inherit;">
          <iframe
            title="Stud Video"
            style="position:absolute;inset:0;width:100%;height:100%;border:0;"
            loading="lazy"
            allowfullscreen
            src="https://www.youtube-nocookie.com/embed/${videoId}"
          ></iframe>
        </div>
      </div>
    ` : ""}

    <p class="dog-desc">${d.desc || ""}</p>
  </div>
`;

          <h3 class="dog-name">${d.name || ""}</h3>
          <p class="dog-ped">${d.pedigree || ""}</p>
          <p class="dog-desc">${d.desc || ""}</p>

          ${d.certImg ? `
            <a href="#" class="mini-link" id="pedLink">${t("pedigreeOpen") || "Pedigree"}</a>

            <div class="photo" id="pedWrap" style="display:none; margin-top:10px;">
              <img src="${d.certImg}" alt="Pedigree Certificate" loading="lazy" decoding="async" />
            </div>
          ` : ``}
        </div>
      `;
      grid.appendChild(card);

      const pedLink = card.querySelector("#pedLink");
      const pedWrap = card.querySelector("#pedWrap");
      if(pedLink && pedWrap){
        pedLink.addEventListener("click", (e)=>{
          e.preventDefault();
          const open = pedWrap.style.display === "none";
          pedWrap.style.display = open ? "block" : "none";
          pedLink.textContent = open
            ? (t("pedigreeClose") || "Hide pedigree")
            : (t("pedigreeOpen")  || "Pedigree");
        });
      }
    }

    function applyLang(){
      const lang = getLang();
      paintLangButtons(lang);

      const tagline = t("tagline");
      if (tagline) safeText($("tagline"), tagline);

    safeText($("studsTitle"), t("navStuds") || "Males");
safeText($("studsLead"),  t("studsLead") || "Featured male with pedigree and description.");


      document.documentElement.lang = lang;

      renderNav();
      renderStud();
    }

    $("langEN")?.addEventListener("click", () => { localStorage.setItem("lang","en"); applyLang(); });
    $("langES")?.addEventListener("click", () => { localStorage.setItem("lang","es"); applyLang(); });

    safeText($("footerBrand"), SITE.brand || "KriB Kennel");
    safeHref($("footerLink"), SITE.footer?.companyUrl || "https://www.raymonddevelop.com");
    safeText($("footerLink"), SITE.footer?.companyLabel || "RaymondDevelop");
    $("year").textContent = new Date().getFullYear();

    applyLang();
  </script>
</body>
</html>
